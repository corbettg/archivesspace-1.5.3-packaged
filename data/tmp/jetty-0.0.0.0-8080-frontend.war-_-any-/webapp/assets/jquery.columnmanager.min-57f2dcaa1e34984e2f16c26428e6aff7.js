(function(c){var d={listTargetID:null,onClass:"",offClass:"",hideInList:[],colsHidden:[],saveState:false,onToggle:null,show:function(k){a(k)},hide:function(k){b(k)}};var e=0;var h="columnManagerC";var g=function(n){var m="",k=0,l=n.cMColsVisible;if(n.cMSaveState&&n.id&&l&&c.cookie){for(;k<l.length;k++){m+=(l[k]==false)?0:1}c.cookie(h+n.id,m,{expires:9999})}};var b=function(k){if(jQuery.browser.msie){(b=function(l){l.style.setAttribute("display","none")})(k)}else{(b=function(l){l.style.display="none"})(k)}};var a=function(k){if(jQuery.browser.msie){(a=function(l){l.style.setAttribute("display","block")})(k)}else{(a=function(l){l.style.display="table-cell"})(k)}};var i=function(k){if(jQuery.browser.msie){return(i=function(l){return l.style.getAttribute("display")!="none"})(k)}else{return(i=function(l){return l.style.display!="none"})(k)}};var f=function(m,k,l){for(var n=0;n<k.length;n++){if(k[n].realIndex===undefined){j(m)}if(k[n].realIndex==l){return k[n]}}return null};var j=function(m){var k=m.rows;var s=k.length;var n=[];for(var u=0;u<s;u++){var l=k[u].cells;var o=l.length;for(var v=0;v<o;v++){var p=l[v];var q=p.rowSpan||1;var t=p.colSpan||1;var r=-1;if(!n[u]){n[u]=[]}var y=n[u];while(y[++r]){}p.realIndex=r;for(var w=u;w<u+q;w++){if(!n[w]){n[w]=[]}var z=n[w];for(var x=r;x<r+t;x++){z[x]=1}}}}};c.fn.columnManager=function(n){var m=c.extend({},d,n);var o=function(q){if(!m.listTargetID){return}var y=c("#"+m.listTargetID);if(!y.length){return}var r=null;if(q.tHead&&q.tHead.length){r=q.tHead.rows[0]}else{if(q.rows.length){r=q.rows[0]}else{return}}var p=r.cells;if(!p.length){return}var w=null;if(y.get(0).nodeName.toUpperCase()=="UL"){w=y}else{w=c("<ul></ul>");y.append(w)}var u=q.cMColsVisible;for(var x=0;x<p.length;x++){if(c.inArray(x+1,m.hideInList)>=0){continue}u[x]=(u[x]!==undefined)?u[x]:true;var s=c(p[x]).text(),v;if(!s.length){s=c(p[x]).html();if(!s.length){s="undefined"}}if(u[x]&&m.onClass){v=m.onClass}else{if(!u[x]&&m.offClass){v=m.offClass}}var t=c('<li class="'+v+'">'+s+"</li>").click(k);t[0].cmData={id:q.id,col:x};w.append(t)}q.cMColsVisible=u};var k=function(){var p=this.cmData;if(p&&p.id&&p.col>=0){var r=p.col,q=c("#"+p.id);if(q.length){q.toggleColumns([r+1],m);var s=q.get(0).cMColsVisible;if(m.onToggle){m.onToggle.apply(q.get(0),[r+1,s[r]])}}}};var l=function(q){var p=c.cookie(h+q);if(p){var s=p.split("");for(var r=0;r<s.length;r++){s[r]&=1}return s}return false};return this.each(function(){this.id=this.id||"jQcM0O"+e++;var q,r=[],s=[];j(this);if(m.colsHidden.length){for(q=0;q<m.colsHidden.length;q++){s[m.colsHidden[q]-1]=true;r[m.colsHidden[q]-1]=true}}if(m.saveState){var p=l(this.id);if(p&&p.length){for(q=0;q<p.length;q++){s[q]=true;r[q]=!p[q]}}this.cMSaveState=true}this.cMColsVisible=s;if(r.length){var t=[];for(q=0;q<r.length;q++){if(r[q]){t[t.length]=q+1}}if(t.length){c(this).toggleColumns(t)}}o(this)})};c.fn.toggleColumns=function(l,k){return this.each(function(){var v,u,s,m=this.rows,t=this.cMColsVisible;if(!l){return}if(l.constructor==Number){l=[l]}if(!t){t=this.cMColsVisible=[]}for(v=0;v<m.length;v++){var n=m[v].cells;for(var w=0;w<l.length;w++){var y=l[w]-1;if(y>=0){var q=f(this,n,y);if(!q){var x=y;while(x>0&&!(q=f(this,n,--x))){}if(!q){continue}}if(t[y]==undefined){t[y]=true}if(t[y]){u=k&&k.hide?k.hide:b;s=-1}else{u=k&&k.show?k.show:a;s=1}if(!q.chSpan){q.chSpan=0}if(q.colSpan>1||(s==1&&q.chSpan&&i(q))){if(q.realIndex+q.colSpan+q.chSpan-1<y){continue}q.colSpan+=s;q.chSpan+=s*-1}else{if(q.realIndex+q.chSpan<y){continue}else{u(q)}}}}}for(v=0;v<l.length;v++){this.cMColsVisible[l[v]-1]=!t[l[v]-1];if(k&&k.listTargetID&&(k.onClass||k.offClass)){var o=k.onClass,p=k.offClass,r;if(t[l[v]-1]){o=p;p=k.onClass}r=c("#"+k.listTargetID+" li").filter(function(){return this.cmData&&this.cmData.col==l[v]-1});if(o){r.removeClass(o)}if(p){r.addClass(p)}}}g(this)})};c.fn.showColumns=function(l,k){return this.each(function(){var n,m=[],o=this.cMColsVisible;if(o){if(l&&l.constructor==Number){l=[l]}for(n=0;n<o.length;n++){if(!o[n]&&(!l||c.inArray(n+1,l)>-1)){m.push(n+1)}}c(this).toggleColumns(m,k)}})};c.fn.hideColumns=function(l,k){return this.each(function(){var n,m=l,o=this.cMColsVisible;if(o){if(l.constructor==Number){l=[l]}m=[];for(n=0;n<l.length;n++){if(o[l[n]-1]||o[l[n]-1]==undefined){m.push(l[n])}}}c(this).toggleColumns(m,k)})}})(jQuery);