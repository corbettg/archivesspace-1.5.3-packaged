(function(a){a.fn.kiketable_colsizable=function(b){b=a.extend({},a.fn.kiketable_colsizable.defaults,b);b.dragProxy=(b.dragProxy==="line")?false:true;this.filter("table:not(."+b.namespace+")").addClass(b.namespace).each(function(e){b.renderTime=new Date().getTime();var c=this,f=a(this),d=c.getElementsByTagName("col");d.length&&a(b.dragCells,this).each(function(g){if(!a(this).hasClass("kiketable-th")){a(this).addClass("kiketable-th").wrapInner('<div class="kiketable-th-text"></div>')}a('<div class="'+b.classHandler+'" title="'+b.title+'"></div>').prependTo(this).each(function(){this.td=this.parentNode;this.$td=a(this.td);this.col=d[this.td.cellIndex]}).dblclick(function(){if(this.wtd==null){this.wtd=this.col.offsetWidth;this.wtd0=this.wtd}var h=this.wtd==b.minWidth;this.wtd=(h)?this.wtd0:b.minWidth;this.col.style.width=this.wtd+"px";if(!b.fixWidth){var i=this.wtd0-b.minWidth;c.style.width=f.width()+((h)?i:-i)+"px"}a(this).trigger("minimized")}).bind("dragstart",function(h){this.cell_width=this.$td.width();this.table_width=f.width();this.left0=h.offsetX;this.d1=this.cell_width-this.left0;this.d2=b.minWidth-this.d1;return a(this).clone().appendTo(this.td).css("opacity",b.dragOpacity).css((b.dragProxy)?{top:this.$td.offset().top,left:this.$td.offset().left,width:this.cell_width}:{top:this.$td.offset().top,left:h.offsetX}).removeClass(b.classHandler).addClass((b.dragProxy)?b.classDragArea:b.classDragLine).height(f.height())}).bind("drag",(b.dragMove||b.dragProxy)?function(i){var h=i.offsetX+this.d1;if(h-this.d2-this.d1>=0){i.dragProxy.style.width=h+"px";if(b.dragMove){this.col.style.width=h+"px";if(!b.fixWidth){c.style.width=(this.table_width-this.cell_width+h)+"px"}}}}:function(i){var h=i.offsetX;if(h-this.d2>=0){i.dragProxy.style.left=h+"px"}}).bind("dragend",function(h){if(!b.dragMove){var i=parseInt(h.dragProxy.style.left)-this.left0;this.col.style.width=(b.dragProxy)?h.dragProxy.style.width:(this.cell_width+i)+"px";if(!b.fixWidth){c.style.width=((b.dragProxy)?this.table_width-this.cell_width+parseInt(h.dragProxy.style.width):this.table_width+i)+"px"}}a(h.dragProxy)[b.fxHide](b.fxSpeed,function(){a(this).remove()});a(this).trigger("minimized")}).bind("minimized",function(h){a(this.col)[(parseInt(this.col.style.width)<=b.minWidth)?"addClass":"removeClass"](b.classMinimized)})});b.renderTime=new Date().getTime()-b.renderTime;b.onLoad()});return this};a.fn.kiketable_colsizable.defaults={dragCells:"tr:first > *",dragMove:true,dragProxy:"line",dragOpacity:0.3,minWidth:8,fixWidth:false,fxHide:"fadeOut",fxSpeed:200,namespace:"kiketable-colsizable",classHandler:"kiketable-colsizable-handler",classDragLine:"kiketable-colsizable-dragLine",classDragArea:"kiketable-colsizable-dragArea",classMinimized:"kiketable-colsizable-minimized",title:"Expand/Collapse this column",renderTime:0,onLoad:function(){}}})(jQuery);